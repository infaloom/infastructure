"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[3672],{2481:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"k3s/environment-variables","title":"Environment Variables","description":"Generate secrets","source":"@site/docs/40-k3s/10-environment-variables.md","sourceDirName":"40-k3s","slug":"/k3s/environment-variables","permalink":"/infastructure/k3s/environment-variables","draft":false,"unlisted":false,"editUrl":"https://github.com/infaloom/infastructure/tree/main/docusaurus/docs/40-k3s/10-environment-variables.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"Provision the cloud resources","permalink":"/infastructure/provisioning-the-cloud-resources/"},"next":{"title":"Setup Ansible environment","permalink":"/infastructure/k3s/setup-ansible-env"}}');var t=r(4848),i=r(8453);const a={},o="Environment Variables",c={},l=[{value:"Generate secrets",id:"generate-secrets",level:2},{value:"Export necessary environment variables",id:"export-necessary-environment-variables",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"environment-variables",children:"Environment Variables"})}),"\n",(0,t.jsx)(n.h2,{id:"generate-secrets",children:"Generate secrets"}),"\n",(0,t.jsx)(n.p,{children:"K3s token:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pulumi --cwd $PULUMI_CWD config set --secret k3s:token $(openssl rand -base64 32)\n"})}),"\n",(0,t.jsx)(n.p,{children:"Cluster domain:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pulumi --cwd $PULUMI_CWD config set --secret cluster:domain {REPLACE_WITH_YOUR_DOMAIN}\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"important",children:[(0,t.jsx)(n.p,{children:"Cluster domain is the domain you will use to access services like Harbor, Grafana, etc. In the later steps we will create wildcard DNS records pointing to the load balancer IP."}),(0,t.jsxs)(n.p,{children:["For example, if your cluster domain is ",(0,t.jsx)(n.code,{children:"infrastructure.example.com"}),", you will create DNS record for:"]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"*.infrastructure.example.com"})," -> Load Balancer IP"]}),"\n"]})]}),"\n",(0,t.jsx)(n.h2,{id:"export-necessary-environment-variables",children:"Export necessary environment variables"}),"\n",(0,t.jsx)(n.p,{children:"You can copy and paste the following commands to set the environment variables required for the K3s installation."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'export K3S_TOKEN=$(pulumi --cwd $PULUMI_CWD config get k3s:token); \\\r\nexport CLUSTER_DOMAIN=$(pulumi --cwd $PULUMI_CWD config get cluster:domain); \\\r\nexport INSTALL_K3S_VERSION="v1.32.3+k3s1"; \\\r\nexport K8S_URL=k8s.${CLUSTER_DOMAIN};\n'})}),"\n",(0,t.jsxs)(n.p,{children:["k3s version can be checked at: ",(0,t.jsx)(n.a,{href:"https://github.com/k3s-io/k3s/releases/tag/v1.32.3+k3s1",children:"https://github.com/k3s-io/k3s/releases/tag/v1.32.3+k3s1"})]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var s=r(6540);const t={},i=s.createContext(t);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);